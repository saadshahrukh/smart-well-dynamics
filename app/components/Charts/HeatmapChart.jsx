import { useEffect, useRef } from "react";
import * as echarts from "echarts";

const HeatmapChart = () => {
  const chartRef = useRef(null); // Create the reference

  useEffect(() => {
    const myChart = echarts.init(chartRef.current); // Initialize the chart with the ref

    const Depth = [
      0, 56.77, 65.9, 75.11, 84.31, 93.3, 102.83, 112.38, 121.35, 130.42,
      139.36, 148.58, 157.6, 166.75, 175.85, 184.91, 191, 215.5, 224.8, 234.13,
      243.28, 252.27, 261.33, 270.3, 279.64, 288.94, 298.27, 307.72, 316.99,
      326.29, 335.6, 344.92, 354.02, 363.33, 372.4, 381.7, 390.62, 399.52,
      408.57, 417.65, 426.78, 435.89, 445, 454.13, 463.34, 472.54, 481.53,
      491.06, 500.61, 509.58, 518.65, 527.59, 536.81, 545.83, 554.98, 564.08,
      573.14, 582.2, 591.72, 601.26, 610.81, 620.35, 629.85, 639.44, 649,
      680.12, 689.67, 699.19, 708.72, 718.22, 727.89, 737.4, 746.96, 756.49,
      765.98, 775.55, 785.1, 794.63, 804.16, 813.67, 823.24, 832.69, 842.2,
      851.82, 861.34, 870.88, 880.43, 889.97, 898.99, 908.39, 917.45, 926.89,
      936.4, 945.55, 954.73, 963.86, 973.39, 982.83, 992.02, 1001.18, 1010.6,
      1019.94, 1029.03, 1038.08, 1047.33, 1056.51, 1065.59, 1074.55, 1083.52,
      1092.82, 1102.15, 1111.3, 1120.29, 1129.35, 1138.32, 1147.66, 1156.96,
      1166.29, 1175.74, 1185.01, 1194.31, 1203.62, 1212.94, 1222.04, 1231.35,
      1240.42, 1249.72, 1258.64, 1267.54, 1276.59, 1285.67, 1294.8, 1303.91,
      1313.02, 1322.15, 1331.36, 1340.56, 1349.55, 1358.86, 1368.41, 1377.38,
      1386.45, 1395.39, 1404.61, 1413.63, 1422.78, 1431,
    ];
    let Dip = [
      [0, 1, 1],
      [0, 2, 1],
      [0, 3, 1],
      [0, 4, 1],
      [0, 5, 1],
      [0, 6, 1],
      [0, 7, 1],
      [0, 8, 1],
      [0, 9, 1],
      [0, 10, 1],
      [0, 11, 1],
      [0, 12, 1],
      [0, 13, 1],
      [0, 14, 1],
      [0, 15, 2],
      [0, 16, 2],
      [0, 17, 2],
      [0, 18, 2],
      [0, 19, 2],
      [0, 20, 1],
      [0, 21, 1],
      [0, 22, 2],
      [0, 23, 1],
      [0, 24, 1],
      [0, 25, 1],
      [0, 26, 1],
      [0, 27, 1],
      [0, 28, 1],
      [0, 29, 1],
      [0, 30, 2],
      [0, 31, 1],
      [0, 32, 1],
      [0, 33, 1],
      [0, 34, 1],
      [0, 35, 1],
      [0, 36, 1],
      [0, 37, 1],
      [0, 38, 1],
      [0, 39, 1],
      [0, 40, 1],
      [0, 41, 1],
      [0, 42, 1],
      [0, 43, 1],
      [0, 44, 1],
      [0, 45, 1],
      [0, 46, 1],
      [0, 47, 1],
      [0, 48, 1],
      [0, 49, 1],
      [0, 50, 1],
      [0, 51, 1],
      [0, 52, 1],
      [0, 53, 1],
      [0, 54, 1],
      [0, 55, 1],
      [0, 56, 1],
      [0, 57, 1],
      [0, 58, 1],
      [0, 59, 2],
      [0, 60, 1],
      [0, 61, 1],
      [0, 62, 1],
      [0, 63, 1],
      [0, 64, 1],
      [0, 65, 1],
      [0, 66, 1],
      [0, 67, 1],
      [0, 68, 1],
      [0, 69, 1],
      [0, 70, 1],
      [0, 71, 1],
      [0, 72, 1],
      [0, 73, 1],
      [0, 74, 1],
      [0, 75, 1],
      [0, 76, 1],
      [0, 77, 1],
      [0, 78, 1],
      [0, 79, 1],
      [0, 80, 1],
      [0, 81, 1],
      [0, 82, 1],
      [0, 83, 1],
      [0, 84, 1],
      [0, 85, 1],
      [0, 86, 1],
      [0, 87, 1],
      [0, 88, 1],
      [0, 89, 1],
      [0, 90, 1],
      [0, 91, 1],
      [0, 92, 1],
      [0, 93, 1],
      [0, 94, 1],
      [0, 95, 1],
      [0, 96, 1],
      [0, 97, 1],
      [0, 98, 1],
      [0, 99, 1],
      [0, 100, 1],
      [0, 101, 1],
      [0, 102, 1],
      [0, 103, 1],
      [0, 104, 1],
      [0, 105, 1],
      [0, 106, 1],
      [0, 107, 1],
      [0, 108, 1],
      [0, 109, 1],
      [0, 110, 1],
      [0, 111, 1],
      [0, 112, 1],
      [0, 113, 1],
      [0, 114, 1],
      [0, 115, 1],
      [0, 116, 1],
      [0, 117, 1],
      [0, 118, 1],
      [0, 119, 1],
      [0, 120, 1],
      [0, 121, 1],
      [0, 122, 1],
      [0, 123, 1],
      [0, 124, 1],
      [0, 125, 1],
      [0, 126, 1],
      [0, 127, 1],
      [0, 128, 1],
      [0, 129, 1],
      [0, 130, 1],
      [0, 131, 1],
      [0, 132, 1],
      [0, 133, 1],
      [0, 134, 1],
      [0, 135, 1],
      [0, 136, 1],
      [0, 137, 1],
      [0, 138, 1],
      [0, 139, 1],
      [0, 140, 1],
      [0, 141, 1],
      [0, 142, 1],
      [0, 143, 1],
      [0, 144, 1],
      [0, 145, 1],
      [0, 146, 1],
      [0, 147, 1],
    ];
    let BT = [
      [1, 1, 1],
      [1, 2, 1],
      [1, 3, 2],
      [1, 4, 2],
      [1, 5, 2],
      [1, 6, 2],
      [1, 7, 2],
      [1, 8, 2],
      [1, 9, 2],
      [1, 10, 2],
      [1, 11, 2],
      [1, 12, 2],
      [1, 13, 2],
      [1, 14, 2],
      [1, 15, 2],
      [1, 16, 2],
      [1, 17, 2],
      [1, 18, 1],
      [1, 19, 1],
      [1, 20, 1],
      [1, 21, 1],
      [1, 22, 1],
      [1, 23, 1],
      [1, 24, 1],
      [1, 25, 1],
      [1, 26, 1],
      [1, 27, 1],
      [1, 28, 1],
      [1, 29, 1],
      [1, 30, 1],
      [1, 31, 1],
      [1, 32, 1],
      [1, 33, 1],
      [1, 34, 1],
      [1, 35, 1],
      [1, 36, 1],
      [1, 37, 1],
      [1, 38, 1],
      [1, 39, 1],
      [1, 40, 1],
      [1, 41, 1],
      [1, 42, 1],
      [1, 43, 1],
      [1, 44, 1],
      [1, 45, 1],
      [1, 46, 1],
      [1, 47, 1],
      [1, 48, 1],
      [1, 49, 1],
      [1, 50, 1],
      [1, 51, 1],
      [1, 52, 2],
      [1, 53, 2],
      [1, 54, 1],
      [1, 55, 1],
      [1, 56, 1],
      [1, 57, 1],
      [1, 58, 1],
      [1, 59, 1],
      [1, 60, 1],
      [1, 61, 1],
      [1, 62, 1],
      [1, 63, 1],
      [1, 64, 1],
      [1, 65, 1],
      [1, 66, 1],
      [1, 67, 1],
      [1, 68, 1],
      [1, 69, 1],
      [1, 70, 1],
      [1, 71, 1],
      [1, 72, 1],
      [1, 73, 1],
      [1, 74, 1],
      [1, 75, 1],
      [1, 76, 1],
      [1, 77, 1],
      [1, 78, 1],
      [1, 79, 1],
      [1, 80, 1],
      [1, 81, 1],
      [1, 82, 1],
      [1, 83, 1],
      [1, 84, 1],
      [1, 85, 1],
      [1, 86, 1],
      [1, 87, 1],
      [1, 88, 1],
      [1, 89, 1],
      [1, 90, 1],
      [1, 91, 1],
      [1, 92, 1],
      [1, 93, 1],
      [1, 94, 1],
      [1, 95, 1],
      [1, 96, 1],
      [1, 97, 1],
      [1, 98, 1],
      [1, 99, 1],
      [1, 100, 1],
      [1, 101, 1],
      [1, 102, 1],
      [1, 103, 1],
      [1, 104, 1],
      [1, 105, 1],
      [1, 106, 1],
      [1, 107, 1],
      [1, 108, 1],
      [1, 109, 1],
      [1, 110, 1],
      [1, 111, 1],
      [1, 112, 1],
      [1, 113, 1],
      [1, 114, 1],
      [1, 115, 1],
      [1, 116, 1],
      [1, 117, 1],
      [1, 118, 1],
      [1, 119, 1],
      [1, 120, 1],
      [1, 121, 1],
      [1, 122, 1],
      [1, 123, 1],
      [1, 124, 1],
      [1, 125, 1],
      [1, 126, 1],
      [1, 127, 1],
      [1, 128, 1],
      [1, 129, 1],
      [1, 130, 1],
      [1, 131, 1],
      [1, 132, 1],
      [1, 133, 1],
      [1, 134, 1],
      [1, 135, 1],
      [1, 136, 1],
      [1, 137, 1],
      [1, 138, 1],
      [1, 139, 1],
      [1, 140, 1],
      [1, 141, 1],
      [1, 142, 1],
      [1, 143, 1],
      [1, 144, 1],
      [1, 145, 1],
      [1, 146, 1],
      [1, 147, 1],
    ];
    let GT = [
      [2, 1, 2],
      [2, 2, 2],
      [2, 3, 2],
      [2, 4, 2],
      [2, 5, 2],
      [2, 6, 2],
      [2, 7, 2],
      [2, 8, 2],
      [2, 9, 2],
      [2, 10, 2],
      [2, 11, 2],
      [2, 12, 2],
      [2, 13, 2],
      [2, 14, 2],
      [2, 15, 2],
      [2, 16, 2],
      [2, 17, 2],
      [2, 18, 1],
      [2, 19, 1],
      [2, 20, 1],
      [2, 21, 1],
      [2, 22, 1],
      [2, 23, 1],
      [2, 24, 1],
      [2, 25, 1],
      [2, 26, 1],
      [2, 27, 1],
      [2, 28, 1],
      [2, 29, 1],
      [2, 30, 1],
      [2, 31, 1],
      [2, 32, 1],
      [2, 33, 1],
      [2, 34, 1],
      [2, 35, 1],
      [2, 36, 1],
      [2, 37, 1],
      [2, 38, 1],
      [2, 39, 2],
      [2, 40, 1],
      [2, 41, 1],
      [2, 42, 2],
      [2, 43, 1],
      [2, 44, 2],
      [2, 45, 1],
      [2, 46, 1],
      [2, 47, 1],
      [2, 48, 1],
      [2, 49, 1],
      [2, 50, 1],
      [2, 51, 1],
      [2, 52, 1],
      [2, 53, 1],
      [2, 54, 2],
      [2, 55, 2],
      [2, 56, 2],
      [2, 57, 1],
      [2, 58, 1],
      [2, 59, 1],
      [2, 60, 2],
      [2, 61, 1],
      [2, 62, 2],
      [2, 63, 2],
      [2, 64, 1],
      [2, 65, 2],
      [2, 66, 1],
      [2, 67, 1],
      [2, 68, 1],
      [2, 69, 1],
      [2, 70, 1],
      [2, 71, 1],
      [2, 72, 1],
      [2, 73, 1],
      [2, 74, 1],
      [2, 75, 1],
      [2, 76, 1],
      [2, 77, 1],
      [2, 78, 1],
      [2, 79, 1],
      [2, 80, 1],
      [2, 81, 1],
      [2, 82, 1],
      [2, 83, 1],
      [2, 84, 1],
      [2, 85, 1],
      [2, 86, 1],
      [2, 87, 1],
      [2, 88, 1],
      [2, 89, 1],
      [2, 90, 1],
      [2, 91, 1],
      [2, 92, 1],
      [2, 93, 1],
      [2, 94, 1],
      [2, 95, 1],
      [2, 96, 1],
      [2, 97, 1],
      [2, 98, 1],
      [2, 99, 1],
      [2, 100, 1],
      [2, 101, 1],
      [2, 102, 1],
      [2, 103, 1],
      [2, 104, 1],
      [2, 105, 1],
      [2, 106, 1],
      [2, 107, 1],
      [2, 108, 1],
      [2, 109, 1],
      [2, 110, 1],
      [2, 111, 1],
      [2, 112, 1],
      [2, 113, 1],
      [2, 114, 1],
      [2, 115, 1],
      [2, 116, 1],
      [2, 117, 1],
      [2, 118, 1],
      [2, 119, 1],
      [2, 120, 1],
      [2, 121, 1],
      [2, 122, 1],
      [2, 123, 1],
      [2, 124, 1],
      [2, 125, 1],
      [2, 126, 1],
      [2, 127, 1],
      [2, 128, 1],
      [2, 129, 1],
      [2, 130, 1],
      [2, 131, 1],
      [2, 132, 1],
      [2, 133, 1],
      [2, 134, 1],
      [2, 135, 1],
      [2, 136, 1],
      [2, 137, 1],
      [2, 138, 1],
      [2, 139, 1],
      [2, 140, 1],
      [2, 141, 1],
      [2, 142, 1],
      [2, 143, 1],
      [2, 144, 1],
      [2, 145, 1],
      [2, 146, 1],
      [2, 147, 1],
    ];

    Dip = Dip.map((item) => [item[1], item[0], item[2]]);
    BT = BT.map((item) => [item[1], item[0], item[2]]);
    GT = GT.map((item) => [item[1], item[0], item[2]]);

    const option = {
      title: {
        text: "Pass / Fail Score Report",
        subtext: "www.smartwelldynamics.com",
        x: "right",
        right: 20,
      },
      visualMap: [
        {
          show: false,
          min: 1,
          max: 2,
          calculable: true,
          color: ["#D8BFD8", "#3CB371"],
        },
      ],
      grid: [
        { top: "20%", height: "9%" },
        { top: "40%", height: "9%" },
        { top: "60%", height: "9%" },
      ],
      dataZoom: [
        {
          type: "slider",
          xAxisIndex: [0, 1, 2],
          realtime: true,
          start: 0,
          end: 100,
          showDetail: true,
          handleSize: "20%",
          top: 270,
        },
        { type: "inside", realtime: true, start: 0, xAxisIndex: [0, 1, 2] },
      ],
      tooltip: {
        show: true,
        position: "top",
        formatter: (params) => {
          if (params.data[2] == "1") {
            return params.seriesName + ": With in Limits !";
          }
          if (params.data[2] == "2") {
            return params.seriesName + ": * Not with in Limits *";
          }
        },
      },
      toolbox: {
        show: true,
        showTitle: true,
        itemGap: 20,
        orient: "vertical",
        left: "right",
        top: 70,
        right: "120",
        feature: {
          restore: { show: true },
        },
      },
      legend: {
        data: ["B Total", "G Total", "Dip"],
        align: "left",
        top: 10,
        left: 20,
        x: "left",
      },
      xAxis: [
        {
          type: "category",
          gridIndex: 0,
          data: Depth,
          axislabel: { show: false },
          axisTick: { show: false },
          axisLine: { show: false },
          splitLine: { show: false },
        },

        {
          type: "category",
          gridIndex: 1,
          data: Depth,
          axislabel: { show: false },
          axisTick: { show: false },
          axisLine: { show: false },
          splitLine: { show: false },
        },

        {
          type: "category",
          gridIndex: 2,
          data: Depth,
          axislabel: { show: false },
          axisTick: { show: false },
          axisLine: { show: false },
          splitLine: { show: false },
        },
      ],
      yAxis: [
        {
          type: "category",
          gridIndex: 0,
          splitNumber: 1,
          name: "B Total",
          nameLocation: "middle",
          nameGap: 20,
          nameRotate: 0,
          nameTextStyle: { fontWeight: "bold" },
          axisLabel: { show: false },
          axisLine: { show: false },
          axisTick: { show: false },
          splitLine: { show: false },
        },
        {
          type: "category",
          gridIndex: 1,
          splitNumber: 1,
          name: "G Total",
          nameLocation: "middle",
          nameGap: 20,
          nameRotate: 0,
          nameTextStyle: { fontWeight: "bold" },
          axisLabel: { show: false },
          axisLine: { show: false },
          axisTick: { show: false },
          splitLine: { show: false },
        },
        {
          type: "category",
          gridIndex: 2,
          splitNumber: 1,
          name: "Dip",
          nameLocation: "middle",
          nameGap: 20,
          nameRotate: 0,
          nameTextStyle: { fontWeight: "bold" },
          axisLabel: { show: false },
          axisLine: { show: false },
          axisTick: { show: false },
          splitLine: { show: false },
        },
      ],
      series: [
        {
          type: "heatmap",
          name: "B Total",
          label: {
            show: false,
            formatter: (params) => parseInt(params.value[2]),
          },
          xAxisIndex: 0,
          yAxisIndex: 0,
          data: BT,
        },
        {
          type: "heatmap",
          name: "G Total",
          label: {
            show: false,
            formatter: (params) => parseInt(params.value[2]),
          },
          xAxisIndex: 1,
          yAxisIndex: 1,
          data: GT,
        },
        {
          type: "heatmap",
          name: "Dip",
          label: {
            show: false,
            formatter: (params) => parseInt(params.value[2]),
          },
          xAxisIndex: 2,
          yAxisIndex: 2,
          data: Dip,
        },
      ],
    };

    if (option && typeof option === "object") {
      myChart.setOption(option, true);
    }

    return () => {
      myChart.dispose();
    };
  }, []);

  return (
    <div className="w-full bg-white shadow-lg p-4 rounded-lg">
      <div ref={chartRef} className="w-full h-[325px]"></div>
    </div>
  );
};

export default HeatmapChart;
